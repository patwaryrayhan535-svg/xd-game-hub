<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sliding Puzzle Game</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 20px;
      }
      #grid {
        display: grid;
        grid-template-columns: repeat(3, 100px);
        grid-template-rows: repeat(3, 100px);
        gap: 5px;
        margin: 20px auto;
        width: 315px;
      }
      .tile {
        width: 100px;
        height: 100px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #4caf50;
        color: white;
        font-size: 24px;
        cursor: pointer;
        border-radius: 5px;
      }
      .empty {
        background-color: #f0f0f0;
        cursor: default;
      }
      #message {
        font-size: 18px;
        margin: 20px 0;
      }
      #reset-btn {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h1>Sliding Puzzle Game</h1>
    <div id="puzzle-container">
      <div id="grid"></div>
    </div>
    <p id="message">Click tiles to move them. Arrange 1-8 in order!</p>
    <button id="reset-btn">Reset Puzzle</button>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const grid = document.getElementById("grid");
        const message = document.getElementById("message");
        const resetBtn = document.getElementById("reset-btn");
        let puzzle = [];

        // Solved state
        const solved = [
          [1, 2, 3],
          [4, 5, 6],
          [7, 8, 0],
        ];

        // Create initial puzzle
        function createPuzzle() {
          puzzle = solved.map((row) => [...row]);
          // Shuffle
          let flat = puzzle.flat().filter((n) => n !== 0);
          do {
            flat.sort(() => Math.random() - 0.5);
            // Check solvability (inversions must be even)
            let inversions = 0;
            for (let i = 0; i < flat.length; i++) {
              for (let j = i + 1; j < flat.length; j++) {
                if (flat[i] > flat[j]) inversions++;
              }
            }
            if (inversions % 2 === 0) break;
          } while (true);
          // Place back into grid
          let idx = 0;
          for (let i = 0; i < 3; i++) {
            for (let j = 0; j < 3; j++) {
              puzzle[i][j] = flat[idx++] || 0;
            }
          }
          renderPuzzle();
        }

        // Render the grid
        function renderPuzzle() {
          grid.innerHTML = "";
          for (let i = 0; i < 3; i++) {
            for (let j = 0; j < 3; j++) {
              const tile = document.createElement("div");
              tile.className = puzzle[i][j] === 0 ? "tile empty" : "tile";
              tile.textContent = puzzle[i][j] === 0 ? "" : puzzle[i][j];
              tile.dataset.row = i;
              tile.dataset.col = j;
              tile.addEventListener("click", () => moveTile(i, j));
              grid.appendChild(tile);
            }
          }
        }

        // Move tile if adjacent to empty
        function moveTile(row, col) {
          const emptyRow = puzzle.findIndex((r) => r.includes(0));
          const emptyCol = puzzle[emptyRow].indexOf(0);
          if (
            (Math.abs(row - emptyRow) === 1 && col === emptyCol) ||
            (Math.abs(col - emptyCol) === 1 && row === emptyRow)
          ) {
            [puzzle[row][col], puzzle[emptyRow][emptyCol]] = [
              puzzle[emptyRow][emptyCol],
              puzzle[row][col],
            ];
            renderPuzzle();
            checkWin();
          }
        }

        // Check if solved
        function checkWin() {
          if (JSON.stringify(puzzle) === JSON.stringify(solved)) {
            message.textContent = "Congratulations! You solved the puzzle!";
          }
        }

        // Reset button
        resetBtn.addEventListener("click", () => {
          message.textContent =
            "Click tiles to move them. Arrange 1-8 in order!";
          createPuzzle();
        });

        // Initialize
        createPuzzle();
      });
    </script>
  </body>
</html>
